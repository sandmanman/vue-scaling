{"remainingRequest":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/components/table/Table.vue?vue&type=style&index=0&lang=scss&","dependencies":[{"path":"/Users/zhangyufan/em/testPro/vue-scale/src/components/table/Table.vue","mtime":1573474128000},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/css-loader/index.js","mtime":1573721989187},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1574242648574},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/postcss-loader/src/index.js","mtime":1573721998387},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/sass-loader/lib/loader.js","mtime":1574242652692},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js","mtime":1574242648574}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n@import './table.scss';\n",{"version":3,"sources":["Table.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAufA","file":"Table.vue","sourceRoot":"src/components/table","sourcesContent":["<template>\r\n  <WSpin\r\n    v-model=\"loading\"\r\n  >\r\n    <div class=\"w-table-wrap\">\r\n      <div\r\n        class=\"w-table-header\"\r\n        v-if=\"isFunction(header)\"\r\n        :class=\"{\r\n          [`w-table-header-${size}`]: size,\r\n          ['w-table-header-border']: border,\r\n        }\"\r\n      >\r\n        <w-render\r\n          :render=\"header\"\r\n        ></w-render>\r\n      </div>\r\n      <div\r\n        class=\"w-table-core\"\r\n        :class=\"{\r\n          ['w-table-core-border']: border,\r\n        }\"\r\n      >\r\n        <div\r\n          :style=\"scrollHeightStyle\"\r\n          ref=\"thead\"\r\n          @scroll=\"scrollingTHeadFn($event)\"\r\n          v-if=\"showHeader\"\r\n        >\r\n          <w-thead\r\n            ref=\"theadCpt\"\r\n            :col=\"theadCol\"\r\n            :colIndex=\"dataIndexCol\"\r\n            :showSort=\"showSort\"\r\n            :options=\"options\"\r\n            :border=\"border\"\r\n            :size=\"size\"\r\n            @change=\"theadChange\"\r\n            :style=\"scrollWidthStyle\"\r\n          >\r\n            <template\r\n              v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n              v-slot:[`header-${slotItem}`]=\"{\r\n                optItem,\r\n                optIndex,\r\n                options,\r\n                colItem,\r\n              }\"\r\n            >\r\n              <slot\r\n                :name=\"`header-${slotItem}`\"\r\n                :colItem=\"colItem\"\r\n                :col=\"dataIndexCol\"\r\n                :optItem=\"optItem\"\r\n                :optIndex=\"optIndex\"\r\n                :options=\"options\"\r\n              ></slot>\r\n            </template>\r\n          </w-thead>\r\n        </div>\r\n        <div\r\n          :class=\"{\r\n            ['w-table-border-top']: !border\r\n          }\"\r\n          ref=\"tbody\"\r\n          :style=\"scrollHeightStyle\"\r\n          @scroll=\"scrollingTBodyFn($event)\"\r\n        >\r\n          <w-tbody\r\n            :col=\"dataIndexCol\"\r\n            :options=\"options\"\r\n            :border=\"border\"\r\n            :size=\"size\"\r\n            :style=\"scrollWidthStyle\"\r\n            @changeHover=\"getHoverIndex\"\r\n            :hoverIndex=\"hoverIndex\"\r\n          >\r\n            <template\r\n              v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n              v-slot:[slotItem]=\"{\r\n                optItem,\r\n                optIndex,\r\n                options,\r\n              }\"\r\n            >\r\n              <slot\r\n                :name=\"slotItem\"\r\n                :col=\"dataIndexCol\"\r\n                :optItem=\"optItem\"\r\n                :optIndex=\"optIndex\"\r\n                :options=\"options\"\r\n              ></slot>\r\n            </template>\r\n          </w-tbody>\r\n        </div>\r\n        <!-- fix left start -->\r\n        <div\r\n          class=\"w-table-fix-wrap w-table-fix-left\"\r\n          :class=\"{\r\n            ['w-table-fix-left-shadow']: scrollLeft,\r\n          }\"\r\n          v-if=\"leftCol.length\"\r\n        >\r\n          <div\r\n            ref=\"theadLeft\"\r\n            v-if=\"showHeader\"\r\n            @scroll=\"scrollingTHeadFn($event)\"\r\n          >\r\n            <w-thead\r\n              ref=\"theadCptLeft\"\r\n              :col=\"leftHeadCol\"\r\n              :colIndex=\"leftCol\"\r\n              fixed\r\n              :showSort=\"showSort\"\r\n              :options=\"options\"\r\n              :border=\"border\"\r\n              :size=\"size\"\r\n              @change=\"theadChange\"\r\n            >\r\n              <template\r\n                v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n                v-slot:[`header-${slotItem}`]=\"{\r\n                  optItem,\r\n                  optIndex,\r\n                  options,\r\n                  colItem,\r\n                }\"\r\n              >\r\n                <slot\r\n                  :name=\"`header-${slotItem}`\"\r\n                  :colItem=\"colItem\"\r\n                  :col=\"dataIndexCol\"\r\n                  :optItem=\"optItem\"\r\n                  :optIndex=\"optIndex\"\r\n                  :options=\"options\"\r\n                ></slot>\r\n              </template>\r\n            </w-thead>\r\n          </div>\r\n          <div\r\n            :class=\"{\r\n              ['w-table-border-top']: !border\r\n            }\"\r\n            ref=\"tbodyLeft\"\r\n            :style=\"scrollHeightStyle\"\r\n            @scroll=\"scrollingTBodyLeftFn($event)\"\r\n          >\r\n            <w-tbody\r\n              :col=\"leftCol\"\r\n              :options=\"options\"\r\n              :border=\"border\"\r\n              :size=\"size\"\r\n              @changeHover=\"getHoverIndex\"\r\n              :hoverIndex=\"hoverIndex\"\r\n            >\r\n              <template\r\n                v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n                v-slot:[slotItem]=\"{\r\n                  optItem,\r\n                  optIndex,\r\n                  options,\r\n                }\"\r\n              >\r\n                <slot\r\n                  :name=\"slotItem\"\r\n                  :col=\"dataIndexCol\"\r\n                  :optItem=\"optItem\"\r\n                  :optIndex=\"optIndex\"\r\n                  :options=\"options\"\r\n                ></slot>\r\n              </template>\r\n            </w-tbody>\r\n          </div>\r\n        </div>\r\n        <!-- fix left end -->\r\n        <!-- fix right start -->\r\n        <div\r\n          class=\"w-table-fix-wrap w-table-fix-right\"\r\n          :class=\"{\r\n            ['w-table-fix-right-shadow']: scrollRight,\r\n          }\"\r\n          v-if=\"rightCol.length\"\r\n        >\r\n          <div\r\n            ref=\"theadRight\"\r\n            v-if=\"showHeader\"\r\n            @scroll=\"scrollingTHeadFn($event)\"\r\n          >\r\n            <w-thead\r\n              ref=\"theadCptRight\"\r\n              :col=\"rightHeadCol\"\r\n              :colIndex=\"rightCol\"\r\n              fixed\r\n              :showSort=\"showSort\"\r\n              :options=\"options\"\r\n              :border=\"border\"\r\n              :size=\"size\"\r\n              @change=\"theadChange\"\r\n            >\r\n              <template\r\n                v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n                v-slot:[`header-${slotItem}`]=\"{\r\n                  optItem,\r\n                  optIndex,\r\n                  options,\r\n                  colItem,\r\n                }\"\r\n              >\r\n                <slot\r\n                  :name=\"`header-${slotItem}`\"\r\n                  :colItem=\"colItem\"\r\n                  :col=\"dataIndexCol\"\r\n                  :optItem=\"optItem\"\r\n                  :optIndex=\"optIndex\"\r\n                  :options=\"options\"\r\n                ></slot>\r\n              </template>\r\n            </w-thead>\r\n          </div>\r\n          <div\r\n            :class=\"{\r\n              ['w-table-border-top']: !border\r\n            }\"\r\n            ref=\"tbodyRight\"\r\n            :style=\"scrollHeightStyle\"\r\n            @scroll=\"scrollingTBodyRightFn($event)\"\r\n          >\r\n            <w-tbody\r\n              :col=\"rightCol\"\r\n              :options=\"options\"\r\n              :border=\"border\"\r\n              :size=\"size\"\r\n              @changeHover=\"getHoverIndex\"\r\n              :hoverIndex=\"hoverIndex\"\r\n            >\r\n              <template\r\n                v-for=\"slotItem in Object.keys($scopedSlots)\"\r\n                v-slot:[slotItem]=\"{\r\n                  optItem,\r\n                  optIndex,\r\n                  options,\r\n                }\"\r\n              >\r\n                <slot\r\n                  :name=\"slotItem\"\r\n                  :col=\"dataIndexCol\"\r\n                  :optItem=\"optItem\"\r\n                  :optIndex=\"optIndex\"\r\n                  :options=\"options\"\r\n                ></slot>\r\n              </template>\r\n            </w-tbody>\r\n          </div>\r\n        </div>\r\n        <!-- fix right end -->\r\n      </div>\r\n      <div\r\n        class=\"w-table-footer\"\r\n        v-if=\"isFunction(footer)\"\r\n        :class=\"{\r\n          [`w-table-footer-${size}`]: size,\r\n          ['w-table-footer-border']: border,\r\n        }\"\r\n      >\r\n        <w-render\r\n          :render=\"footer\"\r\n        ></w-render>\r\n      </div>\r\n    </div>\r\n  </WSpin>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport {\r\n  Component,\r\n  Prop,\r\n  Vue,\r\n} from 'vue-property-decorator';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport WRender from '@/helper/render';\r\nimport { noopArray } from '@/helper/noop';\r\nimport WSpin from '@/components/spin/Spin.vue';\r\nimport WThead from '@/components/table/Thead.vue';\r\nimport WTbody from '@/components/table/Tbody.vue';\r\nimport getValue from '@/helper/getvalue';\r\nimport { isFunction } from '@/helper/type';\r\nimport {\r\n  hasOwn,\r\n} from '@/helper/o';\r\nimport {\r\n  getMaxLevel,\r\n  getAllChildrenLength,\r\n  ChildEntity,\r\n  getCol,\r\n  handleCol,\r\n} from '@/components/table/helper';\r\n\r\ninterface StyleEntity {\r\n  overflowX?: string;\r\n  width?: string | number;\r\n  maxHeight?: string | number;\r\n  overflowY?: string;\r\n}\r\n\r\ninterface ScrollEntity {\r\n  x?: number;\r\n  y?: number;\r\n}\r\n\r\n@Component({\r\n  components: {\r\n    WSpin,\r\n    WThead,\r\n    WTbody,\r\n    WRender,\r\n  },\r\n})\r\nexport default class Table extends Vue {\r\n  hoverIndex: number = -1;\r\n\r\n  scrollLeft: boolean = false;\r\n\r\n  scrollRight: boolean = true;\r\n\r\n  isFunction: Function = isFunction;\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default: noopArray,\r\n  }) private col!: any[];\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default: noopArray,\r\n  }) private options!: any[];\r\n\r\n  @Prop(Boolean) private showSort!: boolean;\r\n\r\n  @Prop(Boolean) private border!: boolean;\r\n\r\n  @Prop(Boolean) private loading!: boolean;\r\n\r\n  @Prop({\r\n    type: Boolean,\r\n    default: true,\r\n  }) private showHeader!: boolean;\r\n\r\n  @Prop(Object) private scroll!: object;\r\n\r\n  @Prop(String) private size!: string;\r\n\r\n  @Prop(Function) private header!: Function;\r\n\r\n  @Prop(Function) private footer!: Function;\r\n\r\n  get theadCol() {\r\n    const copyCol: any[] = cloneDeep(this.col);\r\n    const maxLevel: number = getMaxLevel(copyCol);\r\n    const childLength: ChildEntity = getAllChildrenLength(copyCol);\r\n    const newCol: any[] = [];\r\n\r\n    copyCol.forEach((item: any, itemIndex: number) => {\r\n      getCol(item, String(itemIndex), maxLevel, childLength);\r\n    });\r\n\r\n    handleCol(copyCol, newCol);\r\n\r\n    return newCol;\r\n  }\r\n\r\n  get dataIndexCol() {\r\n    const newCol: any[] = [];\r\n    // 递归累加所有权限输出\r\n    const handleReduce = (item: any, kids: any) => {\r\n      if (hasOwn(kids, 'children') && kids.children.length > 0) {\r\n        kids.children.reduce((kidKeys: any, kid: number) => {\r\n          handleReduce(item, kid);\r\n          return kidKeys;\r\n        }, {});\r\n      } else if (hasOwn(kids, 'dataIndex') && kids.dataIndex.length > 0) {\r\n        newCol.push(kids);\r\n      }\r\n    };\r\n\r\n    this.col.forEach((item: any) => {\r\n      handleReduce(item, item);\r\n    });\r\n\r\n    return newCol;\r\n  }\r\n\r\n  get leftHeadCol() {\r\n    return [this.leftCol];\r\n  }\r\n\r\n  get leftCol() {\r\n    return this.theadCol[0].filter((colItem: any) => colItem.fixed === 'left');\r\n  }\r\n\r\n  get rightHeadCol() {\r\n    return [this.rightCol];\r\n  }\r\n\r\n  get rightCol() {\r\n    return this.theadCol[0].filter((colItem: any) => colItem.fixed === 'right');\r\n  }\r\n\r\n  get scrollWidthStyle() {\r\n    const style: StyleEntity = {};\r\n    const { x }: ScrollEntity = this.scroll || { x: 0, y: 0 };\r\n\r\n    if (x && getValue(x)) {\r\n      style.width = getValue(x);\r\n      style.overflowX = 'auto';\r\n    }\r\n    return style;\r\n  }\r\n\r\n  get scrollHeightStyle() {\r\n    const style: StyleEntity = {};\r\n    const { y }: ScrollEntity = this.scroll || { x: 0, y: 0 };\r\n\r\n    if (y && getValue(y)) {\r\n      style.maxHeight = getValue(y);\r\n      style.overflowY = 'auto';\r\n    }\r\n    return style;\r\n  }\r\n\r\n  clearSort() {\r\n    // 调用子组件方法\r\n    (this.$refs.theadCpt as any).$emit('clearAllSort');\r\n    if (hasOwn(this.$refs, 'theadCptLeft')) {\r\n      (this.$refs.theadCptLeft as any).$emit('clearAllSort');\r\n    }\r\n    if (hasOwn(this.$refs, 'theadCptRight')) {\r\n      (this.$refs.theadCptRight as any).$emit('clearAllSort');\r\n    }\r\n  }\r\n\r\n  scrollingLeft(ev: MouseEvent, targetName: string) {\r\n    const target = ev.target as any;\r\n\r\n    if (ev.currentTarget !== target) {\r\n      return;\r\n    }\r\n\r\n    const { scrollLeft, offsetWidth } = target;\r\n\r\n    this.scrollRight = scrollLeft < target.children[0].offsetWidth - offsetWidth;\r\n    this.scrollLeft = scrollLeft > 0;\r\n\r\n    (this.$refs[targetName] as any).scrollLeft = scrollLeft;\r\n  }\r\n\r\n  scrollingTop(ev: MouseEvent, targetName: string) {\r\n    const target = ev.target as any;\r\n\r\n    if (ev.currentTarget !== target) {\r\n      return;\r\n    }\r\n\r\n    const { scrollTop } = target;\r\n    const scrollElement = this.$refs[targetName] as any;\r\n\r\n    if (scrollElement) {\r\n      scrollElement.scrollTop = scrollTop;\r\n    }\r\n  }\r\n\r\n  scrollingTHeadFn(ev: MouseEvent) {\r\n    this.scrollingLeft(ev, 'tbody');\r\n  }\r\n\r\n  scrollingTBodyFn(ev: MouseEvent) {\r\n    this.scrollingLeft(ev, 'thead');\r\n    this.scrollingTop(ev, 'tbodyLeft');\r\n    this.scrollingTop(ev, 'tbodyRight');\r\n  }\r\n\r\n  scrollingTBodyRightFn(ev: MouseEvent) {\r\n    this.scrollingTop(ev, 'tbodyLeft');\r\n    this.scrollingTop(ev, 'tbody');\r\n  }\r\n\r\n  scrollingTBodyLeftFn(ev: MouseEvent) {\r\n    this.scrollingTop(ev, 'tbodyRight');\r\n    this.scrollingTop(ev, 'tbody');\r\n  }\r\n\r\n  theadChange(params: any) {\r\n    this.$emit('change', params);\r\n  }\r\n\r\n  getHoverIndex(idx = -1) {\r\n    if (this.leftCol.length || this.rightCol.length) {\r\n      this.hoverIndex = idx;\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n  @import './table.scss';\r\n</style>\r\n"]}]}
{"remainingRequest":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/views/components/OnlineReview.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/zhangyufan/em/testPro/vue-scale/src/views/components/OnlineReview.vue","mtime":1573474128000},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js","mtime":1574242632071},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js","mtime":1574332289889},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js","mtime":1574242648574}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport {\r\n  Component,\r\n  Prop,\r\n  Emit,\r\n  Vue,\r\n} from 'vue-property-decorator';\r\nimport WCode from '@/views/components/OnlineCode.vue';\r\nimport WLink from '@/components/link/Link.vue';\r\nimport WAffix from '@/components/affix/Affix.vue';\r\nimport WRender from '@/helper/render';\r\nimport temString from './tem';\r\n\r\n@Component({\r\n  components: {\r\n    WCode,\r\n    WLink,\r\n    WRender,\r\n    WAffix,\r\n  },\r\n})\r\nexport default class Demo extends Vue {\r\n  expendStatus: boolean = false;\r\n\r\n  temCodemirror: any = null;\r\n\r\n  jsCodemirror: any = null;\r\n\r\n  iframe: any = null;\r\n\r\n  codeStatus: string = 'html';\r\n\r\n  isUsed: boolean = false;\r\n\r\n  @Prop(Function) private render!: Function;\r\n\r\n  @Prop(Function) private before!: Function;\r\n\r\n  @Prop(String) private temCode!: string;\r\n\r\n  @Prop(String) private jsCode!: string;\r\n\r\n  @Prop(String) private title!: string;\r\n\r\n  @Prop(String) private desc!: string;\r\n\r\n  @Prop(String) private iframeHeight!: string;\r\n\r\n  @Prop(Object) private data!: object;\r\n\r\n  mounted() {\r\n    this.iframe = this.$refs.iframe;\r\n    this.updateIframe();\r\n  }\r\n\r\n  @Emit('changeHandle')\r\n  changeHandle(params: any) {\r\n    return params;\r\n  }\r\n\r\n  temMounted(cm: any) {\r\n    this.temCodemirror = cm;\r\n  }\r\n\r\n  jsMounted(cm: any) {\r\n    this.jsCodemirror = cm;\r\n  }\r\n\r\n  updateIframe() {\r\n    const tem = this.temCodemirror.getValue();\r\n    const js = this.jsCode ? this.jsCodemirror.getValue() : '';\r\n\r\n    this.renderIframe();\r\n\r\n    if (this.iframe) {\r\n      const preview = this.iframe.contentDocument || this.iframe.contentWindow.document;\r\n      preview.open();\r\n      preview.write(temString(tem, js));\r\n      preview.close();\r\n    }\r\n  }\r\n\r\n  renderIframe() {\r\n    const boxEle = this.$refs.box as any;\r\n    const oldIframe = boxEle.firstChild;\r\n\r\n    if (oldIframe.nodeName === 'IFRAME') {\r\n      boxEle.removeChild(oldIframe);\r\n    }\r\n\r\n    const iframeEle = document.createElement('iframe');\r\n    boxEle.insertBefore(iframeEle, boxEle.firstChild);\r\n\r\n    iframeEle.style.height = this.iframeHeight || '';\r\n\r\n    this.iframe = iframeEle;\r\n  }\r\n\r\n  changeCodeStatus(type: string) {\r\n    this.codeStatus = type;\r\n    this.testAffixUsed();\r\n  }\r\n\r\n  handleExpendStatus() {\r\n    this.expendStatus = !this.expendStatus;\r\n    this.testAffixUsed();\r\n  }\r\n\r\n  testAffixUsed() {\r\n    this.$nextTick(() => {\r\n      const boxRect = (this.$refs.box as any).getBoundingClientRect();\r\n      this.isUsed = boxRect.y + boxRect.height - window.innerHeight < 0;\r\n    });\r\n  }\r\n\r\n  affixChange() {\r\n    const boxRect = (this.$refs.box as any).getBoundingClientRect();\r\n    this.isUsed = boxRect.y < 40 - boxRect.height;\r\n  }\r\n}\r\n",{"version":3,"sources":["OnlineReview.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA","file":"OnlineReview.vue","sourceRoot":"src/views/components","sourcesContent":["<template>\r\n  <section class=\"demo-box\" ref=\"box\">\r\n    <section class=\"demo-meta\" ref=\"meta\">\r\n      <a class=\"demo-title\">{{title}}</a>\r\n      <p class=\"demo-desc\" v-html=\"desc\"></p>\r\n      <div class=\"demo-actions-panel\">\r\n        <WAffix\r\n          :disabled=\"!expendStatus || isUsed\"\r\n          :offsetTop=\"0\"\r\n          @change=\"affixChange\"\r\n        >\r\n          <div class=\"demo-actions\" :class=\"expendStatus ? 'demo-actions-on' : ''\">\r\n              <WLink\r\n                class=\"demo-actions-btn\"\r\n                @click.native=\"handleExpendStatus\"\r\n              >{{expendStatus ? '收起' : '展开'}}代码</WLink>\r\n            <WLink\r\n              class=\"demo-actions-run\"\r\n              v-if=\"expendStatus && !jsCode\"\r\n              @click.native=\"updateIframe\"\r\n            >运行</WLink>\r\n          </div>\r\n        </WAffix>\r\n      </div>\r\n    </section>\r\n    <section\r\n      class=\"demo-core\"\r\n      :style=\"{height: expendStatus ? 'auto' : '0'}\"\r\n    >\r\n      <nav class=\"demo-nav\" v-if=\"jsCode\">\r\n        <a\r\n          class=\"demo-nav-btn\"\r\n          :class=\"codeStatus === 'html' ? 'demo-nav-btn-on' : ''\"\r\n          href=\"javascript:;\"\r\n          @click=\"changeCodeStatus('html')\"\r\n        >Html</a>\r\n        <a\r\n          class=\"demo-nav-btn\"\r\n          :class=\"codeStatus === 'js' ? 'demo-nav-btn-on' : ''\"\r\n          href=\"javascript:;\"\r\n          @click=\"changeCodeStatus('js')\"\r\n        >JavaScript</a>\r\n        <a class=\"demo-nav-run\" href=\"javascript:;\" @click=\"updateIframe\">运行</a>\r\n      </nav>\r\n      <WCode\r\n        @mounted=\"jsMounted\"\r\n        v-model=\"jsCode\"\r\n        v-if=\"jsCode\"\r\n        lang=\"js\"\r\n        :style=\"codeStatus === 'js' ? '' : 'height: 0;overflow: hidden;'\"\r\n        class=\"demo-core-inner\"\r\n      ></WCode>\r\n      <WCode\r\n        @mounted=\"temMounted\"\r\n        v-model=\"temCode\"\r\n        :style=\"codeStatus === 'html' ? '' : 'height: 0;overflow: hidden;'\"\r\n        class=\"demo-core-inner\"\r\n      ></WCode>\r\n    </section>\r\n  </section>\r\n</template>\r\n\r\n<script lang=\"ts\">\r\nimport {\r\n  Component,\r\n  Prop,\r\n  Emit,\r\n  Vue,\r\n} from 'vue-property-decorator';\r\nimport WCode from '@/views/components/OnlineCode.vue';\r\nimport WLink from '@/components/link/Link.vue';\r\nimport WAffix from '@/components/affix/Affix.vue';\r\nimport WRender from '@/helper/render';\r\nimport temString from './tem';\r\n\r\n@Component({\r\n  components: {\r\n    WCode,\r\n    WLink,\r\n    WRender,\r\n    WAffix,\r\n  },\r\n})\r\nexport default class Demo extends Vue {\r\n  expendStatus: boolean = false;\r\n\r\n  temCodemirror: any = null;\r\n\r\n  jsCodemirror: any = null;\r\n\r\n  iframe: any = null;\r\n\r\n  codeStatus: string = 'html';\r\n\r\n  isUsed: boolean = false;\r\n\r\n  @Prop(Function) private render!: Function;\r\n\r\n  @Prop(Function) private before!: Function;\r\n\r\n  @Prop(String) private temCode!: string;\r\n\r\n  @Prop(String) private jsCode!: string;\r\n\r\n  @Prop(String) private title!: string;\r\n\r\n  @Prop(String) private desc!: string;\r\n\r\n  @Prop(String) private iframeHeight!: string;\r\n\r\n  @Prop(Object) private data!: object;\r\n\r\n  mounted() {\r\n    this.iframe = this.$refs.iframe;\r\n    this.updateIframe();\r\n  }\r\n\r\n  @Emit('changeHandle')\r\n  changeHandle(params: any) {\r\n    return params;\r\n  }\r\n\r\n  temMounted(cm: any) {\r\n    this.temCodemirror = cm;\r\n  }\r\n\r\n  jsMounted(cm: any) {\r\n    this.jsCodemirror = cm;\r\n  }\r\n\r\n  updateIframe() {\r\n    const tem = this.temCodemirror.getValue();\r\n    const js = this.jsCode ? this.jsCodemirror.getValue() : '';\r\n\r\n    this.renderIframe();\r\n\r\n    if (this.iframe) {\r\n      const preview = this.iframe.contentDocument || this.iframe.contentWindow.document;\r\n      preview.open();\r\n      preview.write(temString(tem, js));\r\n      preview.close();\r\n    }\r\n  }\r\n\r\n  renderIframe() {\r\n    const boxEle = this.$refs.box as any;\r\n    const oldIframe = boxEle.firstChild;\r\n\r\n    if (oldIframe.nodeName === 'IFRAME') {\r\n      boxEle.removeChild(oldIframe);\r\n    }\r\n\r\n    const iframeEle = document.createElement('iframe');\r\n    boxEle.insertBefore(iframeEle, boxEle.firstChild);\r\n\r\n    iframeEle.style.height = this.iframeHeight || '';\r\n\r\n    this.iframe = iframeEle;\r\n  }\r\n\r\n  changeCodeStatus(type: string) {\r\n    this.codeStatus = type;\r\n    this.testAffixUsed();\r\n  }\r\n\r\n  handleExpendStatus() {\r\n    this.expendStatus = !this.expendStatus;\r\n    this.testAffixUsed();\r\n  }\r\n\r\n  testAffixUsed() {\r\n    this.$nextTick(() => {\r\n      const boxRect = (this.$refs.box as any).getBoundingClientRect();\r\n      this.isUsed = boxRect.y + boxRect.height - window.innerHeight < 0;\r\n    });\r\n  }\r\n\r\n  affixChange() {\r\n    const boxRect = (this.$refs.box as any).getBoundingClientRect();\r\n    this.isUsed = boxRect.y < 40 - boxRect.height;\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scope>\r\n  @import \"../../assets/style/components/demo.scss\";\r\n</style>\r\n"]}]}
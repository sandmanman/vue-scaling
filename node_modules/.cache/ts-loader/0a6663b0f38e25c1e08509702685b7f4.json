{"remainingRequest":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js!/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js??ref--14-2!/Users/zhangyufan/em/testPro/vue-scale/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhangyufan/em/testPro/vue-scale/src/components/input/Inp.ts","dependencies":[{"path":"/Users/zhangyufan/em/testPro/vue-scale/src/components/input/Inp.ts","mtime":1573474128000},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js","mtime":1574242632071},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js","mtime":1574332289889},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js","mtime":1574242646426}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\nimport _classCallCheck from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Model, Prop, Vue, Watch } from 'vue-property-decorator';\nimport { getMaxLengthValue } from '@/components/input/helpers';\nimport { isKorean } from '@/helper/type';\n\nvar Inp =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(Inp, _Vue);\n\n  function Inp() {\n    var _this;\n\n    _classCallCheck(this, Inp);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Inp).apply(this, arguments));\n    _this.name = 'Input';\n    _this.preName = 'w-input-';\n    _this.beError = false;\n    _this.isWriting = false;\n    return _this;\n  }\n\n  _createClass(Inp, [{\n    key: \"mounted\",\n    value: function mounted() {\n      this.beError = this.error({\n        ev: undefined,\n        value: this.value,\n        maxLength: this.maxLength,\n        eventType: 'init'\n      });\n    }\n  }, {\n    key: \"handleCompositionStart\",\n    value: function handleCompositionStart() {\n      this.isWriting = true;\n    }\n  }, {\n    key: \"handleCompositionUpdate\",\n    value: function handleCompositionUpdate(ev) {\n      var text = ev.target.value;\n      var lastCharacter = text[text.length - 1] || '';\n      this.isWriting = !isKorean(lastCharacter);\n    }\n  }, {\n    key: \"handleCompositionEnd\",\n    value: function handleCompositionEnd(ev) {\n      if (this.isWriting) {\n        this.isWriting = false;\n        this.inputHandle(ev);\n      }\n    }\n  }, {\n    key: \"inputHandle\",\n    value: function inputHandle(ev) {\n      // 如果中文正在输入，不及时更新 v-model ，输入之后再更新\n      if (this.isWriting) {\n        return;\n      }\n\n      var target = ev.target;\n      var value = target.value;\n      var reParams = {\n        ev: ev,\n        value: value,\n        maxLength: this.maxLength,\n        eventType: 'input'\n      };\n      target.value = getMaxLengthValue(value, this.maxLength);\n      this.beError = this.error(reParams);\n      this.$emit('model', getMaxLengthValue(value, this.maxLength));\n      this.$emit('change', reParams);\n      this.change(reParams);\n    }\n  }, {\n    key: \"inputError\",\n    value: function inputError() {\n      var newMax = Number(this.maxLength);\n      return newMax > 0 && String(this.value).length > newMax;\n    }\n  }, {\n    key: \"render\",\n    value: function render(h) {\n      var _this2 = this;\n\n      return h('input', {\n        class: this.classList,\n        attrs: {\n          type: this.type,\n          placeholder: this.placeholder,\n          value: this.value,\n          disabled: this.disabled,\n          readonly: this.readonly\n        },\n        ref: 'inpEle',\n        on: {\n          compositionstart: this.handleCompositionStart,\n          compositionupdate: this.handleCompositionUpdate,\n          compositionend: this.handleCompositionEnd,\n          input: this.inputHandle.bind(this),\n          blur: function blur() {\n            _this2.beError = _this2.error({\n              ev: undefined,\n              value: _this2.value,\n              maxLength: _this2.maxLength,\n              eventType: 'blur'\n            });\n          }\n        }\n      });\n    }\n  }, {\n    key: \"getValue\",\n    value: function getValue() {\n      this.$refs.inpEle.value = this.value;\n    }\n  }, {\n    key: \"classList\",\n    get: function get() {\n      return [\"w-input\".concat(this.size ? \"-\".concat(this.size) : ''), {\n        'w-input-disabled': this.disabled,\n        'w-input-error': this.inputError() || this.beError,\n        'w-input-readonly': this.readonly\n      }];\n    }\n  }]);\n\n  return Inp;\n}(Vue);\n\ntslib_1.__decorate([Model('model', {\n  type: [String, Number]\n})], Inp.prototype, \"value\", void 0);\n\ntslib_1.__decorate([Prop([String, Number])], Inp.prototype, \"maxLength\", void 0);\n\ntslib_1.__decorate([Prop(String)], Inp.prototype, \"placeholder\", void 0);\n\ntslib_1.__decorate([Prop(String)], Inp.prototype, \"size\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: String,\n  default: 'text'\n})], Inp.prototype, \"type\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Inp.prototype, \"disabled\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Inp.prototype, \"readonly\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Function,\n  default: function _default() {\n    return false;\n  }\n})], Inp.prototype, \"error\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Function,\n  default: function _default() {}\n})], Inp.prototype, \"change\", void 0);\n\ntslib_1.__decorate([Watch('value')], Inp.prototype, \"getValue\", null);\n\nInp = tslib_1.__decorate([Component], Inp);\nexport default Inp;",{"version":3,"sources":["/Users/zhangyufan/em/testPro/vue-scale/node_modules/@vue/cli-plugin-eslint/node_modules/eslint-loader/index.js??ref--13-0!/Users/zhangyufan/em/testPro/vue-scale/src/components/input/Inp.ts"],"names":[],"mappings":"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","sourcesContent":["import { VNode } from 'vue';\r\nimport {\r\n  Component,\r\n  Model,\r\n  Prop,\r\n  Vue,\r\n  Watch,\r\n} from 'vue-property-decorator';\r\nimport { getMaxLengthValue } from '@/components/input/helpers';\r\nimport { isKorean } from '@/helper/type';\r\n\r\nexport interface ReturnParamsEntity {\r\n  ev: Event;\r\n  value: string;\r\n  maxLength: string | number;\r\n  eventType: string,\r\n}\r\n\r\n@Component\r\nexport default class Inp extends Vue {\r\n  name: string = 'Input';\r\n\r\n  preName: string = 'w-input-';\r\n\r\n  beError: boolean = false;\r\n\r\n  isWriting: boolean = false;\r\n\r\n  @Model('model', { type: [String, Number] }) readonly value!: string | number;\r\n\r\n  @Prop([String, Number]) private maxLength!: string | number;\r\n\r\n  @Prop(String) private placeholder!: string;\r\n\r\n  @Prop(String) private size!: string;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: 'text',\r\n  }) private type!: string;\r\n\r\n  @Prop(Boolean) private disabled!: boolean;\r\n\r\n  @Prop(Boolean) private readonly!: boolean;\r\n\r\n  @Prop({\r\n    type: Function,\r\n    default: (): boolean => false,\r\n  }) private error?: Function;\r\n\r\n  @Prop({\r\n    type: Function,\r\n    default: () => {},\r\n  }) private change?: Function;\r\n\r\n  get classList(): any[] {\r\n    return [\r\n      `w-input${this.size ? `-${this.size}` : ''}`,\r\n      {\r\n        'w-input-disabled': this.disabled,\r\n        'w-input-error': this.inputError() || this.beError,\r\n        'w-input-readonly': this.readonly,\r\n      },\r\n    ];\r\n  }\r\n\r\n  mounted() {\r\n    this.beError = (this.error as Function)({\r\n      ev: undefined,\r\n      value: this.value,\r\n      maxLength: this.maxLength,\r\n      eventType: 'init',\r\n    });\r\n  }\r\n\r\n  handleCompositionStart() {\r\n    this.isWriting = true;\r\n  }\r\n\r\n  handleCompositionUpdate(ev: Event) {\r\n    const text = (ev.target as any).value;\r\n    const lastCharacter = text[text.length - 1] || '';\r\n    this.isWriting = !isKorean(lastCharacter);\r\n  }\r\n\r\n  handleCompositionEnd(ev: Event) {\r\n    if (this.isWriting) {\r\n      this.isWriting = false;\r\n      this.inputHandle(ev);\r\n    }\r\n  }\r\n\r\n  inputHandle(ev: Event): void {\r\n    // 如果中文正在输入，不及时更新 v-model ，输入之后再更新\r\n    if (this.isWriting) {\r\n      return;\r\n    }\r\n\r\n    const target = (ev.target as any);\r\n    const { value } = target;\r\n    const reParams: ReturnParamsEntity = {\r\n      ev,\r\n      value,\r\n      maxLength: this.maxLength,\r\n      eventType: 'input',\r\n    };\r\n\r\n    target.value = getMaxLengthValue(value, this.maxLength);\r\n\r\n    this.beError = (this.error as Function)(reParams);\r\n    this.$emit('model', getMaxLengthValue(value, this.maxLength));\r\n    this.$emit('change', reParams);\r\n    (this.change as Function)(reParams);\r\n  }\r\n\r\n  inputError() {\r\n    const newMax = Number(this.maxLength);\r\n    return newMax > 0 && String(this.value).length > newMax;\r\n  }\r\n\r\n  render(h: Function): VNode {\r\n    return h('input', {\r\n      class: this.classList,\r\n      attrs: {\r\n        type: this.type,\r\n        placeholder: this.placeholder,\r\n        value: this.value,\r\n        disabled: this.disabled,\r\n        readonly: this.readonly,\r\n      },\r\n      ref: 'inpEle',\r\n      on: {\r\n        compositionstart: this.handleCompositionStart,\r\n        compositionupdate: this.handleCompositionUpdate,\r\n        compositionend: this.handleCompositionEnd,\r\n        input: this.inputHandle.bind(this),\r\n        blur: () => {\r\n          this.beError = (this.error as Function)({\r\n            ev: undefined,\r\n            value: this.value,\r\n            maxLength: this.maxLength,\r\n            eventType: 'blur',\r\n          });\r\n        },\r\n      },\r\n    });\r\n  }\r\n\r\n  @Watch('value')\r\n  getValue() {\r\n    (this.$refs.inpEle as any).value = this.value;\r\n  }\r\n}\r\n"],"sourceRoot":""}]}
{"remainingRequest":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js!/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js??ref--14-2!/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/components/table/Table.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/zhangyufan/em/testPro/vue-scale/src/components/table/Table.vue","mtime":1573474128000},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js","mtime":1574242632071},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js","mtime":1574332289889},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js","mtime":1574242648574}],"contextDependencies":[],"result":["import \"core-js/modules/es6.string.fixed\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _classCallCheck from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Prop, Vue } from 'vue-property-decorator';\nimport cloneDeep from 'lodash/cloneDeep';\nimport WRender from '@/helper/render';\nimport { noopArray } from '@/helper/noop';\nimport WSpin from '@/components/spin/Spin.vue';\nimport WThead from '@/components/table/Thead.vue';\nimport WTbody from '@/components/table/Tbody.vue';\nimport getValue from '@/helper/getvalue';\nimport { isFunction } from '@/helper/type';\nimport { hasOwn } from '@/helper/o';\nimport { getMaxLevel, getAllChildrenLength, getCol, handleCol } from '@/components/table/helper';\n\nvar Table =\n/*#__PURE__*/\nfunction (_Vue) {\n  _inherits(Table, _Vue);\n\n  function Table() {\n    var _this;\n\n    _classCallCheck(this, Table);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Table).apply(this, arguments));\n    _this.hoverIndex = -1;\n    _this.scrollLeft = false;\n    _this.scrollRight = true;\n    _this.isFunction = isFunction;\n    return _this;\n  }\n\n  _createClass(Table, [{\n    key: \"clearSort\",\n    value: function clearSort() {\n      // 调用子组件方法\n      this.$refs.theadCpt.$emit('clearAllSort');\n\n      if (hasOwn(this.$refs, 'theadCptLeft')) {\n        this.$refs.theadCptLeft.$emit('clearAllSort');\n      }\n\n      if (hasOwn(this.$refs, 'theadCptRight')) {\n        this.$refs.theadCptRight.$emit('clearAllSort');\n      }\n    }\n  }, {\n    key: \"scrollingLeft\",\n    value: function scrollingLeft(ev, targetName) {\n      var target = ev.target;\n\n      if (ev.currentTarget !== target) {\n        return;\n      }\n\n      var scrollLeft = target.scrollLeft,\n          offsetWidth = target.offsetWidth;\n      this.scrollRight = scrollLeft < target.children[0].offsetWidth - offsetWidth;\n      this.scrollLeft = scrollLeft > 0;\n      this.$refs[targetName].scrollLeft = scrollLeft;\n    }\n  }, {\n    key: \"scrollingTop\",\n    value: function scrollingTop(ev, targetName) {\n      var target = ev.target;\n\n      if (ev.currentTarget !== target) {\n        return;\n      }\n\n      var scrollTop = target.scrollTop;\n      var scrollElement = this.$refs[targetName];\n\n      if (scrollElement) {\n        scrollElement.scrollTop = scrollTop;\n      }\n    }\n  }, {\n    key: \"scrollingTHeadFn\",\n    value: function scrollingTHeadFn(ev) {\n      this.scrollingLeft(ev, 'tbody');\n    }\n  }, {\n    key: \"scrollingTBodyFn\",\n    value: function scrollingTBodyFn(ev) {\n      this.scrollingLeft(ev, 'thead');\n      this.scrollingTop(ev, 'tbodyLeft');\n      this.scrollingTop(ev, 'tbodyRight');\n    }\n  }, {\n    key: \"scrollingTBodyRightFn\",\n    value: function scrollingTBodyRightFn(ev) {\n      this.scrollingTop(ev, 'tbodyLeft');\n      this.scrollingTop(ev, 'tbody');\n    }\n  }, {\n    key: \"scrollingTBodyLeftFn\",\n    value: function scrollingTBodyLeftFn(ev) {\n      this.scrollingTop(ev, 'tbodyRight');\n      this.scrollingTop(ev, 'tbody');\n    }\n  }, {\n    key: \"theadChange\",\n    value: function theadChange(params) {\n      this.$emit('change', params);\n    }\n  }, {\n    key: \"getHoverIndex\",\n    value: function getHoverIndex() {\n      var idx = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : -1;\n\n      if (this.leftCol.length || this.rightCol.length) {\n        this.hoverIndex = idx;\n      }\n    }\n  }, {\n    key: \"theadCol\",\n    get: function get() {\n      var copyCol = cloneDeep(this.col);\n      var maxLevel = getMaxLevel(copyCol);\n      var childLength = getAllChildrenLength(copyCol);\n      var newCol = [];\n      copyCol.forEach(function (item, itemIndex) {\n        getCol(item, String(itemIndex), maxLevel, childLength);\n      });\n      handleCol(copyCol, newCol);\n      return newCol;\n    }\n  }, {\n    key: \"dataIndexCol\",\n    get: function get() {\n      var newCol = []; // 递归累加所有权限输出\n\n      var handleReduce = function handleReduce(item, kids) {\n        if (hasOwn(kids, 'children') && kids.children.length > 0) {\n          kids.children.reduce(function (kidKeys, kid) {\n            handleReduce(item, kid);\n            return kidKeys;\n          }, {});\n        } else if (hasOwn(kids, 'dataIndex') && kids.dataIndex.length > 0) {\n          newCol.push(kids);\n        }\n      };\n\n      this.col.forEach(function (item) {\n        handleReduce(item, item);\n      });\n      return newCol;\n    }\n  }, {\n    key: \"leftHeadCol\",\n    get: function get() {\n      return [this.leftCol];\n    }\n  }, {\n    key: \"leftCol\",\n    get: function get() {\n      return this.theadCol[0].filter(function (colItem) {\n        return colItem.fixed === 'left';\n      });\n    }\n  }, {\n    key: \"rightHeadCol\",\n    get: function get() {\n      return [this.rightCol];\n    }\n  }, {\n    key: \"rightCol\",\n    get: function get() {\n      return this.theadCol[0].filter(function (colItem) {\n        return colItem.fixed === 'right';\n      });\n    }\n  }, {\n    key: \"scrollWidthStyle\",\n    get: function get() {\n      var style = {};\n\n      var _ref = this.scroll || {\n        x: 0,\n        y: 0\n      },\n          x = _ref.x;\n\n      if (x && getValue(x)) {\n        style.width = getValue(x);\n        style.overflowX = 'auto';\n      }\n\n      return style;\n    }\n  }, {\n    key: \"scrollHeightStyle\",\n    get: function get() {\n      var style = {};\n\n      var _ref2 = this.scroll || {\n        x: 0,\n        y: 0\n      },\n          y = _ref2.y;\n\n      if (y && getValue(y)) {\n        style.maxHeight = getValue(y);\n        style.overflowY = 'auto';\n      }\n\n      return style;\n    }\n  }]);\n\n  return Table;\n}(Vue);\n\ntslib_1.__decorate([Prop({\n  type: Array,\n  default: noopArray\n})], Table.prototype, \"col\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Array,\n  default: noopArray\n})], Table.prototype, \"options\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Table.prototype, \"showSort\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Table.prototype, \"border\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Table.prototype, \"loading\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Boolean,\n  default: true\n})], Table.prototype, \"showHeader\", void 0);\n\ntslib_1.__decorate([Prop(Object)], Table.prototype, \"scroll\", void 0);\n\ntslib_1.__decorate([Prop(String)], Table.prototype, \"size\", void 0);\n\ntslib_1.__decorate([Prop(Function)], Table.prototype, \"header\", void 0);\n\ntslib_1.__decorate([Prop(Function)], Table.prototype, \"footer\", void 0);\n\nTable = tslib_1.__decorate([Component({\n  components: {\n    WSpin: WSpin,\n    WThead: WThead,\n    WTbody: WTbody,\n    WRender: WRender\n  }\n})], Table);\nexport default Table;",{"version":3,"sources":["/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/components/table/Table.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport {\r\n  Component,\r\n  Prop,\r\n  Vue,\r\n} from 'vue-property-decorator';\r\nimport cloneDeep from 'lodash/cloneDeep';\r\nimport WRender from '@/helper/render';\r\nimport { noopArray } from '@/helper/noop';\r\nimport WSpin from '@/components/spin/Spin.vue';\r\nimport WThead from '@/components/table/Thead.vue';\r\nimport WTbody from '@/components/table/Tbody.vue';\r\nimport getValue from '@/helper/getvalue';\r\nimport { isFunction } from '@/helper/type';\r\nimport {\r\n  hasOwn,\r\n} from '@/helper/o';\r\nimport {\r\n  getMaxLevel,\r\n  getAllChildrenLength,\r\n  ChildEntity,\r\n  getCol,\r\n  handleCol,\r\n} from '@/components/table/helper';\r\n\r\ninterface StyleEntity {\r\n  overflowX?: string;\r\n  width?: string | number;\r\n  maxHeight?: string | number;\r\n  overflowY?: string;\r\n}\r\n\r\ninterface ScrollEntity {\r\n  x?: number;\r\n  y?: number;\r\n}\r\n\r\n@Component({\r\n  components: {\r\n    WSpin,\r\n    WThead,\r\n    WTbody,\r\n    WRender,\r\n  },\r\n})\r\nexport default class Table extends Vue {\r\n  hoverIndex: number = -1;\r\n\r\n  scrollLeft: boolean = false;\r\n\r\n  scrollRight: boolean = true;\r\n\r\n  isFunction: Function = isFunction;\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default: noopArray,\r\n  }) private col!: any[];\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default: noopArray,\r\n  }) private options!: any[];\r\n\r\n  @Prop(Boolean) private showSort!: boolean;\r\n\r\n  @Prop(Boolean) private border!: boolean;\r\n\r\n  @Prop(Boolean) private loading!: boolean;\r\n\r\n  @Prop({\r\n    type: Boolean,\r\n    default: true,\r\n  }) private showHeader!: boolean;\r\n\r\n  @Prop(Object) private scroll!: object;\r\n\r\n  @Prop(String) private size!: string;\r\n\r\n  @Prop(Function) private header!: Function;\r\n\r\n  @Prop(Function) private footer!: Function;\r\n\r\n  get theadCol() {\r\n    const copyCol: any[] = cloneDeep(this.col);\r\n    const maxLevel: number = getMaxLevel(copyCol);\r\n    const childLength: ChildEntity = getAllChildrenLength(copyCol);\r\n    const newCol: any[] = [];\r\n\r\n    copyCol.forEach((item: any, itemIndex: number) => {\r\n      getCol(item, String(itemIndex), maxLevel, childLength);\r\n    });\r\n\r\n    handleCol(copyCol, newCol);\r\n\r\n    return newCol;\r\n  }\r\n\r\n  get dataIndexCol() {\r\n    const newCol: any[] = [];\r\n    // 递归累加所有权限输出\r\n    const handleReduce = (item: any, kids: any) => {\r\n      if (hasOwn(kids, 'children') && kids.children.length > 0) {\r\n        kids.children.reduce((kidKeys: any, kid: number) => {\r\n          handleReduce(item, kid);\r\n          return kidKeys;\r\n        }, {});\r\n      } else if (hasOwn(kids, 'dataIndex') && kids.dataIndex.length > 0) {\r\n        newCol.push(kids);\r\n      }\r\n    };\r\n\r\n    this.col.forEach((item: any) => {\r\n      handleReduce(item, item);\r\n    });\r\n\r\n    return newCol;\r\n  }\r\n\r\n  get leftHeadCol() {\r\n    return [this.leftCol];\r\n  }\r\n\r\n  get leftCol() {\r\n    return this.theadCol[0].filter((colItem: any) => colItem.fixed === 'left');\r\n  }\r\n\r\n  get rightHeadCol() {\r\n    return [this.rightCol];\r\n  }\r\n\r\n  get rightCol() {\r\n    return this.theadCol[0].filter((colItem: any) => colItem.fixed === 'right');\r\n  }\r\n\r\n  get scrollWidthStyle() {\r\n    const style: StyleEntity = {};\r\n    const { x }: ScrollEntity = this.scroll || { x: 0, y: 0 };\r\n\r\n    if (x && getValue(x)) {\r\n      style.width = getValue(x);\r\n      style.overflowX = 'auto';\r\n    }\r\n    return style;\r\n  }\r\n\r\n  get scrollHeightStyle() {\r\n    const style: StyleEntity = {};\r\n    const { y }: ScrollEntity = this.scroll || { x: 0, y: 0 };\r\n\r\n    if (y && getValue(y)) {\r\n      style.maxHeight = getValue(y);\r\n      style.overflowY = 'auto';\r\n    }\r\n    return style;\r\n  }\r\n\r\n  clearSort() {\r\n    // 调用子组件方法\r\n    (this.$refs.theadCpt as any).$emit('clearAllSort');\r\n    if (hasOwn(this.$refs, 'theadCptLeft')) {\r\n      (this.$refs.theadCptLeft as any).$emit('clearAllSort');\r\n    }\r\n    if (hasOwn(this.$refs, 'theadCptRight')) {\r\n      (this.$refs.theadCptRight as any).$emit('clearAllSort');\r\n    }\r\n  }\r\n\r\n  scrollingLeft(ev: MouseEvent, targetName: string) {\r\n    const target = ev.target as any;\r\n\r\n    if (ev.currentTarget !== target) {\r\n      return;\r\n    }\r\n\r\n    const { scrollLeft, offsetWidth } = target;\r\n\r\n    this.scrollRight = scrollLeft < target.children[0].offsetWidth - offsetWidth;\r\n    this.scrollLeft = scrollLeft > 0;\r\n\r\n    (this.$refs[targetName] as any).scrollLeft = scrollLeft;\r\n  }\r\n\r\n  scrollingTop(ev: MouseEvent, targetName: string) {\r\n    const target = ev.target as any;\r\n\r\n    if (ev.currentTarget !== target) {\r\n      return;\r\n    }\r\n\r\n    const { scrollTop } = target;\r\n    const scrollElement = this.$refs[targetName] as any;\r\n\r\n    if (scrollElement) {\r\n      scrollElement.scrollTop = scrollTop;\r\n    }\r\n  }\r\n\r\n  scrollingTHeadFn(ev: MouseEvent) {\r\n    this.scrollingLeft(ev, 'tbody');\r\n  }\r\n\r\n  scrollingTBodyFn(ev: MouseEvent) {\r\n    this.scrollingLeft(ev, 'thead');\r\n    this.scrollingTop(ev, 'tbodyLeft');\r\n    this.scrollingTop(ev, 'tbodyRight');\r\n  }\r\n\r\n  scrollingTBodyRightFn(ev: MouseEvent) {\r\n    this.scrollingTop(ev, 'tbodyLeft');\r\n    this.scrollingTop(ev, 'tbody');\r\n  }\r\n\r\n  scrollingTBodyLeftFn(ev: MouseEvent) {\r\n    this.scrollingTop(ev, 'tbodyRight');\r\n    this.scrollingTop(ev, 'tbody');\r\n  }\r\n\r\n  theadChange(params: any) {\r\n    this.$emit('change', params);\r\n  }\r\n\r\n  getHoverIndex(idx = -1) {\r\n    if (this.leftCol.length || this.rightCol.length) {\r\n      this.hoverIndex = idx;\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}]}
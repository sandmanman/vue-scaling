{"remainingRequest":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js!/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js??ref--14-2!/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/components/cascader/Cascader.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/Users/zhangyufan/em/testPro/vue-scale/src/components/cascader/Cascader.vue","mtime":1573474128000},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/babel-loader/lib/index.js","mtime":1574242632071},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/ts-loader/index.js","mtime":1574332289889},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js","mtime":1573721989004},{"path":"/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js","mtime":1574242648574}],"contextDependencies":[],"result":["import _Promise from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.regexp.search\";\nimport _defineProperty from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/zhangyufan/em/testPro/vue-scale/node_modules/@babel/runtime-corejs2/helpers/esm/inherits\";\nimport * as tslib_1 from \"tslib\";\nimport { Component, Model, Prop, Emit, Vue } from 'vue-property-decorator';\nimport { mixins } from 'vue-class-component';\nimport addDOMEventListener from 'add-dom-event-listener';\nimport TransferDom from '@/directives/transfer-dom';\nimport docClick from '@/directives/doclick';\nimport { hasOwn } from '@/helper/o';\nimport { findEnabled } from '@/helper/option';\nimport { noop } from '@/helper/noop';\nimport { fieldNamesDefault } from './entity';\nimport { setPostion } from '@/helper/poper';\nimport poperMixin from '@/helper/popermixin';\nimport WCascaderPanel from './CascaderPanel.vue';\nimport WCascaderRender from './cascader-render';\nimport WCascaderSearch from './cascader-search';\nimport { objToPath, getValueByLabel } from './helper';\nVue.directive('transfer-dom', TransferDom);\nVue.directive('doc-click', docClick);\n\nvar Cascader =\n/*#__PURE__*/\nfunction (_mixins) {\n  _inherits(Cascader, _mixins);\n\n  function Cascader() {\n    var _this;\n\n    _classCallCheck(this, Cascader);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Cascader).apply(this, arguments));\n    _this.optStatus = false;\n    _this.searchKeyWord = '';\n    _this.searchHoverIndex = -1;\n    _this.searchResult = []; // 如果没指定 v-model ，就存到这里，以便使用数组引用进行更新\n    // 解决不传 v-model ， 点击选中三级 ， 再显示，不选再关上，删除之后的问题\n\n    _this.defValue = [];\n    _this.chooseResult = []; // 点击下拉选项，最后一级之后所得到的值\n\n    _this.chooseAllItem = []; // 点击下拉选项每一级选择的数据\n\n    _this.chooseItemResult = []; // 点击下拉选项每一级选择的数据\n\n    _this.currentOption = {};\n    _this.resizeEvent = null;\n    return _this;\n  }\n\n  _createClass(Cascader, [{\n    key: \"mounted\",\n    value: function mounted() {\n      this.defValue = this.realValue.slice();\n      this.resizeEvent = addDOMEventListener(window, 'resize', this.resizeChange);\n    }\n  }, {\n    key: \"beforeDestroy\",\n    value: function beforeDestroy() {\n      this.resizeEvent.remove();\n    }\n  }, {\n    key: \"resizeChange\",\n    value: function resizeChange() {\n      setPostion(this, 'cascader');\n    }\n  }, {\n    key: \"updateValue\",\n    value: function updateValue(value) {\n      if (this.hasValue) {\n        this.$emit('model', value);\n      } else {\n        this.defValue = value;\n      }\n    }\n  }, {\n    key: \"panelChange\",\n    value: function panelChange(params, ev) {\n      var _this$currentOption;\n\n      var current = params.current,\n          item = params.item,\n          index = params.index,\n          floor = params.floor;\n      var value = params[this.fieldNames.value];\n      var children = params[this.fieldNames.children];\n      this.currentOption = (_this$currentOption = {}, _defineProperty(_this$currentOption, this.fieldNames.value, value), _defineProperty(_this$currentOption, \"current\", current), _defineProperty(_this$currentOption, \"index\", index), _defineProperty(_this$currentOption, \"floor\", floor), _defineProperty(_this$currentOption, this.fieldNames.children, children), _defineProperty(_this$currentOption, \"ev\", ev), _defineProperty(_this$currentOption, \"item\", item), _defineProperty(_this$currentOption, \"options\", this.options), _this$currentOption);\n      this.chooseAllItem.push(item);\n      this.updateValue(value);\n      this.change(this.currentOption, ev); // 如果到最后一个选项了就更新显示，在不及时显示选项的模式( changeOnSelect )下\n\n      if (!children.length) {\n        this.chooseItemResult = this.chooseAllItem.slice();\n        this.chooseResult = value.slice();\n      }\n\n      return this.currentOption;\n    }\n  }, {\n    key: \"cascaderClick\",\n    value: function cascaderClick(ev) {\n      var _this2 = this;\n\n      if (!this.disabledValue && !this.loading) {\n        this.before().then(function () {\n          _this2.setStatus(true);\n\n          _this2.$nextTick(function () {\n            setPostion(_this2, 'cascader');\n\n            if (_this2.search) {\n              _this2.searchFocus();\n            }\n\n            _this2.$emit('click', ev);\n\n            _this2.click(ev);\n          });\n        });\n      }\n    }\n  }, {\n    key: \"bodyClick\",\n    value: function bodyClick() {\n      if (this.optStatus) {\n        this.setStatus(false);\n        this.reset();\n        this.searchReset();\n      }\n    } // 清除当前选中的所有\n\n  }, {\n    key: \"popValue\",\n    value: function popValue() {\n      var value = this.hasValue ? this.value : this.defValue; // 清除所有\n\n      while (value.length) {\n        value.pop();\n      }\n\n      return value;\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      if (hasOwn(this.currentOption, this.fieldNames.children) && this.currentOption[this.fieldNames.children].length) {\n        var value = this.popValue();\n        var oldValue = this.chooseResult.length > 0 ? this.chooseResult : this.defValue; // // 恢复之前设置的\n\n        oldValue.forEach(function (res) {\n          value.push(res);\n        });\n        this.updateValue(value);\n        this.chooseAllItem = this.chooseItemResult.slice();\n        this.chooseItemResult = [];\n      }\n    }\n  }, {\n    key: \"clear\",\n    value: function clear(ev) {\n      this.chooseResult = []; // 删除了就连原始已经有的默认值也删除\n\n      this.defValue = []; // 清除所有\n\n      this.updateValue(this.popValue());\n\n      if (this.search && this.searchKeyWord) {\n        this.searchReset();\n        this.searchFocus();\n      }\n\n      ev.stopPropagation();\n    }\n  }, {\n    key: \"setStatus\",\n    value: function setStatus(val) {\n      this.optStatus = val;\n    }\n  }, {\n    key: \"searchFocus\",\n    value: function searchFocus() {\n      var inputElement = this.$refs.input;\n\n      if (inputElement) {\n        inputElement.focus();\n      }\n    }\n  }, {\n    key: \"searchblur\",\n    value: function searchblur() {\n      var inputElement = this.$refs.input;\n\n      if (inputElement) {\n        inputElement.blur();\n      }\n    }\n  }, {\n    key: \"searchChange\",\n    value: function searchChange(searchOption, ev) {\n      this.panelChange(searchOption, ev);\n      this.searchReset();\n    }\n  }, {\n    key: \"getSearchResult\",\n    value: function getSearchResult(result) {\n      this.searchResult = result;\n    }\n  }, {\n    key: \"searchEnter\",\n    value: function searchEnter(ev) {\n      if (this.searchResult.length) {\n        var _this$searchResult$Ma = this.searchResult[Math.max(this.searchHoverIndex, 0)],\n            item = _this$searchResult$Ma.item,\n            index = _this$searchResult$Ma.index,\n            floor = _this$searchResult$Ma.floor;\n        var searchResult = this.searchResult[Math.max(this.searchHoverIndex, 0)];\n        var value = searchResult[this.fieldNames.value];\n        var label = searchResult[this.fieldNames.label] || [];\n        var children = searchResult[this.fieldNames.children];\n        var changeParams = {\n          value: label.slice(),\n          label: label,\n          current: value[value.length - 1],\n          item: item,\n          index: index,\n          floor: floor,\n          children: children\n        };\n        this.panelChange(changeParams, ev);\n      }\n\n      this.searchReset();\n      this.setStatus(false);\n      this.searchblur();\n    }\n  }, {\n    key: \"searchKeyDown\",\n    value: function searchKeyDown() {\n      // 递增索引\n      this.searchHoverIndex = ++this.searchHoverIndex % this.searchResult.length; // 略过不可用\n\n      this.searchHoverIndex = findEnabled(this.searchResult, this.searchHoverIndex, 1, this.fieldNames);\n    }\n  }, {\n    key: \"searchKeyUp\",\n    value: function searchKeyUp() {\n      // 递减索引\n      this.searchHoverIndex = (this.searchResult.length + --this.searchHoverIndex) % this.searchResult.length; // 略过不可用\n\n      this.searchHoverIndex = findEnabled(this.searchResult, this.searchHoverIndex, -1, this.fieldNames);\n    }\n  }, {\n    key: \"searchReset\",\n    value: function searchReset() {\n      this.searchHoverIndex = -1;\n      this.searchKeyWord = '';\n    }\n  }, {\n    key: \"searchData\",\n    get: function get() {\n      return objToPath(this.options.slice(), this.fieldNames).slice();\n    }\n  }, {\n    key: \"hasValue\",\n    get: function get() {\n      return !!this.value;\n    }\n  }, {\n    key: \"chooseValue\",\n    get: function get() {\n      return getValueByLabel(this.realValue, this.options, this.fieldNames).slice();\n    }\n  }, {\n    key: \"realValue\",\n    get: function get() {\n      var value = this.hasValue ? this.value : this.defValue;\n      return value.slice();\n    }\n  }, {\n    key: \"disabledValue\",\n    get: function get() {\n      return this.disabled;\n    }\n  }, {\n    key: \"optionClass\",\n    get: function get() {\n      return {\n        'w-cascader-option-show': this.optStatus\n      };\n    }\n  }]);\n\n  return Cascader;\n}(mixins(poperMixin));\n\ntslib_1.__decorate([Model('model', {\n  type: Array\n})], Cascader.prototype, \"value\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Array,\n  default: noop\n})], Cascader.prototype, \"options\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: String,\n  default: '未匹配到结果'\n})], Cascader.prototype, \"emptyText\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: String,\n  default: ''\n})], Cascader.prototype, \"searchWidth\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: String,\n  default: '请选择'\n})], Cascader.prototype, \"placeholder\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: String,\n  default: 'bottomLeft'\n})], Cascader.prototype, \"placement\", void 0);\n\ntslib_1.__decorate([Prop(String)], Cascader.prototype, \"size\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Cascader.prototype, \"loading\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Cascader.prototype, \"disabled\", void 0);\n\ntslib_1.__decorate([Prop(Boolean)], Cascader.prototype, \"search\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Boolean,\n  default: true\n})], Cascader.prototype, \"transfer\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Number,\n  default: 4\n})], Cascader.prototype, \"interval\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Object,\n  default: function _default() {\n    return fieldNamesDefault;\n  }\n})], Cascader.prototype, \"fieldNames\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Function,\n  default: function _default() {\n    var _this3 = this;\n\n    return new _Promise(function (resolve) {\n      _this3.$nextTick(function () {\n        resolve();\n      });\n    });\n  }\n})], Cascader.prototype, \"before\", void 0);\n\ntslib_1.__decorate([Prop(Function)], Cascader.prototype, \"getContainer\", void 0);\n\ntslib_1.__decorate([Prop(Function)], Cascader.prototype, \"searchRender\", void 0);\n\ntslib_1.__decorate([Prop(Function)], Cascader.prototype, \"displayRender\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Function,\n  default: noop\n})], Cascader.prototype, \"change\", void 0);\n\ntslib_1.__decorate([Prop({\n  type: Function,\n  default: noop\n})], Cascader.prototype, \"click\", void 0);\n\ntslib_1.__decorate([Emit('change')], Cascader.prototype, \"panelChange\", null);\n\nCascader = tslib_1.__decorate([Component({\n  components: {\n    WCascaderPanel: WCascaderPanel,\n    WCascaderRender: WCascaderRender,\n    WCascaderSearch: WCascaderSearch\n  }\n})], Cascader);\nexport default Cascader;",{"version":3,"sources":["/Users/zhangyufan/em/testPro/vue-scale/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/zhangyufan/em/testPro/vue-scale/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/zhangyufan/em/testPro/vue-scale/src/components/cascader/Cascader.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport {\r\n  Component,\r\n  Model,\r\n  Prop,\r\n  Emit,\r\n  Vue,\r\n} from 'vue-property-decorator';\r\nimport { mixins } from 'vue-class-component';\r\nimport addDOMEventListener from 'add-dom-event-listener';\r\nimport TransferDom from '@/directives/transfer-dom';\r\nimport docClick from '@/directives/doclick';\r\nimport { hasOwn } from '@/helper/o';\r\nimport { findEnabled } from '@/helper/option';\r\nimport { noop } from '@/helper/noop';\r\nimport {\r\n  OptionsEntity,\r\n  FieldNamesEntity,\r\n  ReturnParamsEntity,\r\n  fieldNamesDefault,\r\n} from './entity';\r\nimport {\r\n  setPostion,\r\n} from '@/helper/poper';\r\nimport poperMixin from '@/helper/popermixin';\r\nimport WCascaderPanel from './CascaderPanel.vue';\r\nimport WCascaderRender from './cascader-render';\r\nimport WCascaderSearch from './cascader-search';\r\nimport { objToPath, getValueByLabel } from './helper';\r\n\r\nVue.directive('transfer-dom', (TransferDom as any));\r\n\r\nVue.directive('doc-click', (docClick as any));\r\n\r\n@Component({\r\n  components: {\r\n    WCascaderPanel,\r\n    WCascaderRender,\r\n    WCascaderSearch,\r\n  },\r\n})\r\nexport default class Cascader extends mixins(poperMixin) {\r\n  optStatus: boolean = false;\r\n\r\n  searchKeyWord: string = '';\r\n\r\n  searchHoverIndex: number = -1;\r\n\r\n  searchResult: any[] = [];\r\n\r\n  // 如果没指定 v-model ，就存到这里，以便使用数组引用进行更新\r\n  // 解决不传 v-model ， 点击选中三级 ， 再显示，不选再关上，删除之后的问题\r\n  defValue: string[] = [];\r\n\r\n  chooseResult: any[] = []; // 点击下拉选项，最后一级之后所得到的值\r\n\r\n  chooseAllItem: any[] = []; // 点击下拉选项每一级选择的数据\r\n\r\n  chooseItemResult: any[] = []; // 点击下拉选项每一级选择的数据\r\n\r\n  currentOption: any = {};\r\n\r\n  resizeEvent: any = null;\r\n\r\n  @Model('model', { type: Array }) readonly value!: string[];\r\n\r\n  @Prop({\r\n    type: Array,\r\n    default: noop,\r\n  }) private options!: any[];\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: '未匹配到结果',\r\n  }) private emptyText!: string;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: '',\r\n  }) private searchWidth!: string;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: '请选择',\r\n  }) private placeholder!: string;\r\n\r\n  @Prop({\r\n    type: String,\r\n    default: 'bottomLeft',\r\n  }) private placement!: string;\r\n\r\n  @Prop(String) private size!: string;\r\n\r\n  @Prop(Boolean) private loading!: boolean;\r\n\r\n  @Prop(Boolean) private disabled!: boolean;\r\n\r\n  @Prop(Boolean) private search!: boolean;\r\n\r\n  @Prop({\r\n    type: Boolean,\r\n    default: true,\r\n  }) private transfer!: boolean;\r\n\r\n  @Prop({\r\n    type: Number,\r\n    default: 4,\r\n  }) private interval!: number;\r\n\r\n  @Prop({\r\n    type: Object,\r\n    default: (): FieldNamesEntity => fieldNamesDefault,\r\n  }) private fieldNames!: FieldNamesEntity;\r\n\r\n  @Prop({\r\n    type: Function,\r\n    default() {\r\n      return new Promise((resolve) => {\r\n        (this as any).$nextTick(() => {\r\n          resolve();\r\n        });\r\n      });\r\n    },\r\n  }) private before!: Function;\r\n\r\n  @Prop(Function) private getContainer!: Function;\r\n\r\n  @Prop(Function) private searchRender!: Function;\r\n\r\n  @Prop(Function) private displayRender!: Function;\r\n\r\n  @Prop({\r\n    type: Function,\r\n    default: noop,\r\n  }) private change!: Function;\r\n\r\n  @Prop({\r\n    type: Function,\r\n    default: noop,\r\n  }) private click!: Function;\r\n\r\n  get searchData() {\r\n    return objToPath(this.options.slice(), this.fieldNames).slice();\r\n  }\r\n\r\n  get hasValue() {\r\n    return !!this.value;\r\n  }\r\n\r\n  get chooseValue() {\r\n    return getValueByLabel(this.realValue, this.options, this.fieldNames).slice();\r\n  }\r\n\r\n  get realValue() {\r\n    const value = this.hasValue ? this.value : this.defValue;\r\n    return value.slice();\r\n  }\r\n\r\n  get disabledValue() {\r\n    return this.disabled;\r\n  }\r\n\r\n  get optionClass() {\r\n    return {\r\n      'w-cascader-option-show': this.optStatus,\r\n    };\r\n  }\r\n\r\n  mounted() {\r\n    this.defValue = this.realValue.slice();\r\n    this.resizeEvent = addDOMEventListener(window, 'resize', this.resizeChange);\r\n  }\r\n\r\n  beforeDestroy() {\r\n    this.resizeEvent.remove();\r\n  }\r\n\r\n  resizeChange() {\r\n    setPostion(this, 'cascader');\r\n  }\r\n\r\n  updateValue(value: string[]) {\r\n    if (this.hasValue) {\r\n      this.$emit('model', value);\r\n    } else {\r\n      this.defValue = value;\r\n    }\r\n  }\r\n\r\n  @Emit('change')\r\n  panelChange(params: ReturnParamsEntity, ev: MouseEvent) {\r\n    const {\r\n      current, item, index, floor,\r\n    } = params;\r\n    const value = params[this.fieldNames.value];\r\n    const children = params[this.fieldNames.children];\r\n    this.currentOption = {\r\n      [this.fieldNames.value]: value,\r\n      current,\r\n      index,\r\n      floor,\r\n      [this.fieldNames.children]: children,\r\n      ev,\r\n      item,\r\n      options: this.options,\r\n    };\r\n\r\n    this.chooseAllItem.push(item);\r\n\r\n    this.updateValue(value);\r\n    this.change(this.currentOption, ev);\r\n    // 如果到最后一个选项了就更新显示，在不及时显示选项的模式( changeOnSelect )下\r\n    if (!children.length) {\r\n      this.chooseItemResult = this.chooseAllItem.slice();\r\n      this.chooseResult = value.slice();\r\n    }\r\n\r\n    return this.currentOption;\r\n  }\r\n\r\n  cascaderClick(ev: MouseEvent) {\r\n    if (!this.disabledValue && !this.loading) {\r\n      this.before().then(() => {\r\n        this.setStatus(true);\r\n        this.$nextTick(() => {\r\n          setPostion(this, 'cascader');\r\n          if (this.search) {\r\n            this.searchFocus();\r\n          }\r\n          this.$emit('click', ev);\r\n          this.click(ev);\r\n        });\r\n      });\r\n    }\r\n  }\r\n\r\n  bodyClick() {\r\n    if (this.optStatus) {\r\n      this.setStatus(false);\r\n      this.reset();\r\n      this.searchReset();\r\n    }\r\n  }\r\n\r\n  // 清除当前选中的所有\r\n  popValue() {\r\n    const value = this.hasValue ? this.value : this.defValue;\r\n    // 清除所有\r\n    while (value.length) {\r\n      value.pop();\r\n    }\r\n    return value;\r\n  }\r\n\r\n  reset() {\r\n    if (\r\n      hasOwn(this.currentOption, this.fieldNames.children)\r\n      && this.currentOption[this.fieldNames.children].length\r\n    ) {\r\n      const value = this.popValue();\r\n      const oldValue = this.chooseResult.length > 0 ? this.chooseResult : this.defValue;\r\n      // // 恢复之前设置的\r\n      oldValue.forEach((res) => {\r\n        value.push(res);\r\n      });\r\n      this.updateValue(value);\r\n      this.chooseAllItem = this.chooseItemResult.slice();\r\n      this.chooseItemResult = [];\r\n    }\r\n  }\r\n\r\n  clear(ev: MouseEvent) {\r\n    this.chooseResult = [];\r\n    // 删除了就连原始已经有的默认值也删除\r\n    this.defValue = [];\r\n    // 清除所有\r\n    this.updateValue(this.popValue());\r\n\r\n    if (this.search && this.searchKeyWord) {\r\n      this.searchReset();\r\n      this.searchFocus();\r\n    }\r\n\r\n    ev.stopPropagation();\r\n  }\r\n\r\n  setStatus(val: boolean) {\r\n    this.optStatus = val;\r\n  }\r\n\r\n  searchFocus() {\r\n    const inputElement = this.$refs.input;\r\n    if (inputElement) {\r\n      (inputElement as any).focus();\r\n    }\r\n  }\r\n\r\n  searchblur() {\r\n    const inputElement = this.$refs.input;\r\n    if (inputElement) {\r\n      (inputElement as any).blur();\r\n    }\r\n  }\r\n\r\n  searchChange(searchOption: ReturnParamsEntity, ev: MouseEvent) {\r\n    this.panelChange(searchOption, ev);\r\n    this.searchReset();\r\n  }\r\n\r\n  getSearchResult(result: string[]) {\r\n    this.searchResult = result;\r\n  }\r\n\r\n  searchEnter(ev: MouseEvent) {\r\n    if (this.searchResult.length) {\r\n      const {\r\n        item,\r\n        index,\r\n        floor,\r\n      } = this.searchResult[Math.max(this.searchHoverIndex, 0)];\r\n      const searchResult = this.searchResult[Math.max(this.searchHoverIndex, 0)];\r\n      const value = searchResult[this.fieldNames.value];\r\n      const label = searchResult[this.fieldNames.label] || [];\r\n      const children = searchResult[this.fieldNames.children];\r\n      const changeParams: ReturnParamsEntity = {\r\n        value: label.slice(),\r\n        label,\r\n        current: value[value.length - 1],\r\n        item,\r\n        index,\r\n        floor,\r\n        children,\r\n      };\r\n      this.panelChange(changeParams, ev);\r\n    }\r\n    this.searchReset();\r\n    this.setStatus(false);\r\n    this.searchblur();\r\n  }\r\n\r\n  searchKeyDown() {\r\n    // 递增索引\r\n    this.searchHoverIndex = ++this.searchHoverIndex % this.searchResult.length;\r\n    // 略过不可用\r\n    this.searchHoverIndex = findEnabled(\r\n      this.searchResult,\r\n      this.searchHoverIndex,\r\n      1,\r\n      this.fieldNames,\r\n    );\r\n  }\r\n\r\n  searchKeyUp() {\r\n    // 递减索引\r\n    this.searchHoverIndex = (\r\n      this.searchResult.length + --this.searchHoverIndex\r\n    ) % this.searchResult.length;\r\n    // 略过不可用\r\n    this.searchHoverIndex = findEnabled(\r\n      this.searchResult,\r\n      this.searchHoverIndex,\r\n      -1,\r\n      this.fieldNames,\r\n    );\r\n  }\r\n\r\n  searchReset() {\r\n    this.searchHoverIndex = -1;\r\n    this.searchKeyWord = '';\r\n  }\r\n}\r\n"],"sourceRoot":""}]}